"use strict";!function n(t,e,o){function i(s,r){if(!e[s]){if(!t[s]){var c="function"==typeof require&&require;if(!r&&c)return c(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=e[s]={exports:{}};t[s][0].call(l.exports,function(n){var e=t[s][1][n];return i(e||n)},l,l.exports,n,t,e,o)}return e[s].exports}for(var a="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(n,t,e){function o(){return(0|9e6*Math.random()).toString(36)}Object.defineProperty(e,"__esModule",{value:!0}),e.createRandomId=o},{}],2:[function(n,t,e){function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function n(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}}(),a=n("./Marker"),s=function(n){return n&&n.__esModule?n:{default:n}}(a),r=n("../functions/createRandomId"),c=function(){function n(t,e){o(this,n),this.instanceId=e.instanceId||"",this.container=t,this.markers=[],this.map=null,this.options={},this.defaults={map:{center:{lat:55.1309504,lng:24.5499231},zoom:7,scrollwheel:!1,navigationControl:!0,mapTypeControl:!1,scaleControl:!0,draggable:!0,streetViewControl:!1},infoWindowOn:"click",globalMarkerIcon:""},this.placeInstanceId(e),this.populateOptions(e),this.initMap(),this.collectMarkers()}return i(n,[{key:"placeInstanceId",value:function(){this.instanceId&&this.container.setAttribute("instance",this.instanceId)}},{key:"populateOptions",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"map"in n&&"styles"in n.map&&(n.map.styles=JSON.parse(n.map.styles)),"map"in n&&(n.map=Object.assign(this.defaults.map,n.map)),this.options=Object.assign(this.options,this.defaults,n)}},{key:"initMap",value:function(){var n=this;this.map=new google.maps.Map(this.container,this.options.map),google.maps.event.addDomListener(window,"resize",function(){n.map.setCenter(n.options.map.center)})}},{key:"collectMarkers",value:function(){var n=this,t=this.container.getAttribute("data-markers");""==t&&void 0===t||(t=JSON.parse(t)),t.forEach(function(t){n.markers.push(new s.default(Object.assign(t,{instanceId:(0,r.createRandomId)(),infoWindowOn:n.options.infoWindowOn,icon:""!=n.options.globalMarkerIcon?n.options.globalMarkerIcon:"",events:{onClick:function(t){return n.markers.forEach(function(n){t.getInstanceId()!=n.getInstanceId()&&n.close()})}}}),n.map))})}}]),n}();e.default=c},{"../functions/createRandomId":1,"./Marker":3}],3:[function(n,t,e){function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function n(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}}(),a=function(){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];o(this,n),this.map=e,this.defaults={instanceId:null,location:null,address:"",coordinates:"",displayWindow:!1,content:"",icon:"",markerImage:null,draggable:!1,infoWindowOn:"click",events:{onClick:function(n){},onMouseover:function(n){},onMouseout:function(n){}}},this.temporary={},"events"in t&&(t.events=Object.assign(this.defaults.events,t.events)),this.options=Object.assign(this.defaults,t),this.createInstance(),this.bindEvents()}return i(n,[{key:"update",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=Object.assign(this.options,n),"location"in n&&this.instance.setPosition(n.location),"coordinates"in n){var t=n.coordinates.split(",").map(Number).filter(function(n){return!isNaN(n)});this.options.location=new google.maps.LatLng(t[0],t[1]),this.instance.setPosition(this.options.location)}}},{key:"getCoordinates",value:function(){return this.instance.getPosition().lat()+", "+this.instance.getPosition().lng()}},{key:"getData",value:function(){return{InstanceId:this.options.instanceId,Address:this.options.address,Coordinates:this.getCoordinates(),Content:this.options.content,DisplayWindow:this.options.displayWindow}}},{key:"createInstance",value:function(){if(null==this.options.location&&""!=this.options.coordinates){var n=this.options.coordinates.split(",").map(Number).filter(function(n){return!isNaN(n)});this.options.location=new google.maps.LatLng(n[0],n[1])}this.instance=new google.maps.Marker({map:this.map,icon:this.options.markerImage||this.options.icon,position:this.options.location,draggable:this.options.draggable}),this.instance.infoWindow=new google.maps.InfoWindow({content:this.options.content})}},{key:"bindEvents",value:function(){var n=this;switch(this.options.infoWindowOn){case"click":google.maps.event.addListener(this.instance,"click",function(){n.options.events.onClick(n),n.open()});break;case"hover":google.maps.event.addListener(this.instance,"mouseover",function(){n.options.events.onMouseover(n),n.open()}),google.maps.event.addListener(this.instance,"mouseout",function(){n.options.events.onMouseout(n),n.close()});break;default:return}}},{key:"getInstanceId",value:function(){return this.options.instanceId}},{key:"open",value:function(){this.options.displayWindow&&this.instance.infoWindow.open(this.map,this.instance)}},{key:"close",value:function(){this.instance.infoWindow.close()}}]),n}();e.default=a},{}],4:[function(n,t,e){function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function n(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}}(),a=n("./blocks/maps/modules/GoogleMap"),s=function(n){return n&&n.__esModule?n:{default:n}}(a),r=n("./blocks/maps/functions/createRandomId"),c=function(){function n(){o(this,n),window.GoogleMap={readyApi:!1,api:document.querySelector('meta[property="maps:key"]').getAttribute("content"),instances:[],init:function(){[].forEach.call(document.querySelectorAll('*[data-module="google-map"]'),function(n){var t=(0,r.createRandomId)(),e=n.getAttribute("data-options");e=void 0===e||""==e?{}:JSON.parse(e),window.GoogleMap.instances.push(new s.default(n,Object.assign({instanceId:t},e)))})}}}return i(n,[{key:"init",value:function(){if(!window.GoogleMap.readyApi&&(""!=window.GoogleMap.api||void 0!==window.GoogleMap.api)){var n=document.createElement("script");n.type="text/javascript",n.src="//maps.googleapis.com/maps/api/js?key="+window.GoogleMap.api+"&libraries=places&callback=window.GoogleMap.init",document.body.appendChild(n),window.GoogleMap.readyApi=!0}}}]),n}();document.addEventListener("DOMContentLoaded",function(){if(!("GoogleMap"in window)){(new c).init()}})},{"./blocks/maps/functions/createRandomId":1,"./blocks/maps/modules/GoogleMap":2}]},{},[4]);
//# sourceMappingURL=maps-frontend.js.map
